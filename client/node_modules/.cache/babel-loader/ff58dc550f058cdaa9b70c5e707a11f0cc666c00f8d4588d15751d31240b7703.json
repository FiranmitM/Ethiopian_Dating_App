{"ast":null,"code":"var _jsxFileName = \"/home/franmit/Downloads/Ethiopia_dating_app/client/src/pages/Chat/Chat.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Container, Paper, Grid, useMediaQuery, Typography, Button } from '@mui/material';\nimport { addMessage } from '../../reducers/messagesReducer';\nimport chatService from '../../services/chatService';\nimport ChatBar from './ChatBar';\nimport ChatBody from './ChatBody';\nimport ChatFooter from './ChatFooter';\nimport { changeRoom } from '../../reducers/roomReducer';\nimport { useParams } from 'react-router-dom';\nimport Loader from '../../components/Loader';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NoConnections = () => {\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    spacing: 0,\n    direction: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    style: {\n      minHeight: '50vh'\n    },\n    children: /*#__PURE__*/_jsxDEV(Paper, {\n      sx: {\n        p: 2,\n        mt: 2,\n        pl: 5,\n        pr: 5,\n        display: 'flex',\n        alignItems: 'center',\n        flexDirection: 'column'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h1\",\n        children: \"\\uD83D\\uDE14\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h5\",\n        color: \"#1c1c1c\",\n        children: \"No Connections\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        component: Link,\n        to: \"/browsing\",\n        children: \"Browse more\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 16,\n    columnNumber: 3\n  }, this);\n};\n_c = NoConnections;\nconst Chat = _ref => {\n  _s();\n  let {\n    socket\n  } = _ref;\n  const matches = useMediaQuery(\"(max-width:650px)\");\n  const room = useSelector(state => state.room);\n  const user = useSelector(state => state.user);\n  const [connections, setConnections] = useState(undefined);\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const params = useParams();\n  const joinRoom = useCallback(connection_id => {\n    if (user !== '') {\n      socket.emit('leave_room', {\n        room\n      });\n      if (connection_id !== '') {\n        dispatch(changeRoom(connection_id));\n        socket.emit('join_room', {\n          room: connection_id,\n          user_id: user.id,\n          username: user.name\n        });\n        navigate(`/chat/${connection_id}`);\n      }\n    }\n  }, [dispatch, navigate, room, socket, user]);\n  useEffect(() => {\n    const getConnections = async () => {\n      const connections = await chatService.chat_connections();\n      setConnections(connections);\n    };\n    getConnections();\n  }, []);\n  useEffect(() => {\n    if (params.id && connections && room !== params.id && params.id !== '' && connections.find(connection => connection.connection_id === Number(params.id))) {\n      joinRoom(Number(params.id));\n    }\n  }, [params.id, connections, room, joinRoom]);\n  useEffect(() => {\n    socket.on('receive_message', data => {\n      dispatch(addMessage(data));\n    });\n    return () => socket.off('receive_message');\n  }, [socket, dispatch]);\n  if (!connections) return /*#__PURE__*/_jsxDEV(Loader, {\n    text: \"Loading chat...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 27\n  }, this);\n  if (connections.length === 0) return /*#__PURE__*/_jsxDEV(NoConnections, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 39\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"lg\",\n    sx: {\n      pt: 5,\n      pb: 5\n    },\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      direction: matches ? 'column' : 'row',\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 4,\n        md: 4,\n        children: /*#__PURE__*/_jsxDEV(ChatBar, {\n          connections: connections,\n          joinRoom: joinRoom\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 8,\n        md: 8,\n        children: /*#__PURE__*/_jsxDEV(Paper, {\n          children: [/*#__PURE__*/_jsxDEV(ChatBody, {\n            connections: connections\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(ChatFooter, {\n            socket: socket,\n            connections: connections\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 3\n  }, this);\n};\n_s(Chat, \"fDwDnGhpvMgiZh8T0EBGtBo+xkQ=\", false, function () {\n  return [useMediaQuery, useSelector, useSelector, useDispatch, useNavigate, useParams];\n});\n_c2 = Chat;\nexport default Chat;\nvar _c, _c2;\n$RefreshReg$(_c, \"NoConnections\");\n$RefreshReg$(_c2, \"Chat\");","map":{"version":3,"names":["useEffect","useState","useCallback","useDispatch","useSelector","Link","useNavigate","Container","Paper","Grid","useMediaQuery","Typography","Button","addMessage","chatService","ChatBar","ChatBody","ChatFooter","changeRoom","useParams","Loader","NoConnections","minHeight","p","mt","pl","pr","display","alignItems","flexDirection","Chat","socket","matches","room","state","user","connections","setConnections","undefined","dispatch","navigate","params","joinRoom","connection_id","emit","user_id","id","username","name","getConnections","chat_connections","find","connection","Number","on","data","off","length","pt","pb"],"sources":["/home/franmit/Downloads/Ethiopia_dating_app/client/src/pages/Chat/Chat.js"],"sourcesContent":["import { useEffect, useState, useCallback } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Link, useNavigate } from 'react-router-dom'\nimport { Container, Paper, Grid, useMediaQuery, Typography, Button } from '@mui/material'\nimport { addMessage } from '../../reducers/messagesReducer'\nimport chatService from '../../services/chatService'\nimport ChatBar from './ChatBar'\nimport ChatBody from './ChatBody'\nimport ChatFooter from './ChatFooter'\nimport { changeRoom } from '../../reducers/roomReducer'\nimport { useParams } from 'react-router-dom'\nimport Loader from '../../components/Loader'\n\nconst NoConnections = () => {\n\treturn (\n\t\t<Grid\n\t\t\tcontainer\n\t\t\tspacing={0}\n\t\t\tdirection=\"column\"\n\t\t\talignItems=\"center\"\n\t\t\tjustifyContent=\"center\"\n\t\t\tstyle={{ minHeight: '50vh' }}\n\t\t>\n\t\t\t<Paper sx={{ p: 2, mt: 2, pl: 5, pr: 5, display: 'flex', alignItems: 'center', flexDirection: 'column' }}>\n\t\t\t\t<Typography variant='h1'>ðŸ˜”</Typography>\n\t\t\t\t<Typography variant='h5' color='#1c1c1c'>No Connections</Typography>\n\t\t\t\t<Button component={Link} to='/browsing'>Browse more</Button>\n\t\t\t</Paper>\n\t\t</Grid>\n\t)\n}\n\nconst Chat = ({ socket }) => {\n\tconst matches = useMediaQuery(\"(max-width:650px)\");\n\tconst room = useSelector(state => state.room)\n\tconst user = useSelector(state => state.user)\n\tconst [connections, setConnections] = useState(undefined)\n\tconst dispatch = useDispatch()\n\tconst navigate = useNavigate()\n\tconst params = useParams()\n\n\tconst joinRoom = useCallback((connection_id) => {\n\t\tif (user !== '') {\n\t\t\tsocket.emit('leave_room', { room })\n\t\t\tif (connection_id !== '') {\n\t\t\t\tdispatch(changeRoom(connection_id))\n\t\t\t\tsocket.emit('join_room', {\n\t\t\t\t\troom: connection_id, user_id: user.id, username: user.name\n\t\t\t\t})\n\t\t\t\tnavigate(`/chat/${connection_id}`)\n\t\t\t}\n\t\t}\n\t}, [dispatch, navigate, room, socket, user])\n\n\tuseEffect(() => {\n\t\tconst getConnections = async () => {\n\t\t\tconst connections = await chatService.chat_connections()\n\t\t\tsetConnections(connections)\n\t\t}\n\t\tgetConnections()\n\t}, [])\n\n\n\tuseEffect(() => {\n\t\tif (params.id && connections && room !== params.id && params.id !== ''\n\t\t\t&& connections.find(connection => connection.connection_id === Number(params.id))) {\n\t\t\tjoinRoom(Number(params.id))\n\t\t}\n\t}, [params.id, connections, room, joinRoom])\n\n\tuseEffect(() => {\n\t\tsocket.on('receive_message', (data) => {\n\t\t\tdispatch(addMessage(data))\n\t\t})\n\t\treturn () => socket.off('receive_message')\n\t}, [socket, dispatch])\n\n\tif (!connections) return <Loader text=\"Loading chat...\" />\n\tif (connections.length === 0) return <NoConnections />\n\n\treturn (\n\t\t<Container maxWidth='lg' sx={{ pt: 5, pb: 5 }}>\n\t\t\t<Grid container spacing={2} direction={matches ? 'column' : 'row'}>\n\t\t\t\t<Grid item xs={4} md={4}>\n\t\t\t\t\t<ChatBar\n\t\t\t\t\t\tconnections={connections}\n\t\t\t\t\t\tjoinRoom={joinRoom}\n\t\t\t\t\t/>\n\t\t\t\t</Grid>\n\t\t\t\t<Grid item xs={8} md={8}>\n\t\t\t\t\t<Paper>\n\t\t\t\t\t\t<ChatBody\n\t\t\t\t\t\t\tconnections={connections}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ChatFooter\n\t\t\t\t\t\t\tsocket={socket}\n\t\t\t\t\t\t\tconnections={connections}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Paper>\n\t\t\t\t</Grid>\n\t\t\t</Grid>\n\t\t</Container>\n\t)\n}\n\nexport default Chat\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}